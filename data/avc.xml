<?xml version="1.0"?>

<dlna-profiles>
  <include ref="common.xml" />

  <restrictions>
    <restriction id="AVC_BL_L3_AAC" type="audio">
      <parent name="AAC" />

      <field name="bitrate" type="int">
        <range min="1" max="256000" />
      </field>
    </restriction>

    <restriction id="AVC_BL_C" type="video">
      <field name="name" type="string">
        <value>video/x-h264</value>
      </field>
      <field name="profile" type="string">
        <!-- profile=baseline + constraint_set1_flag=1
                                                == constrained-baseline -->
        <value>constrained-baseline</value>
      </field>
      <field name="format" type="fourcc">
        <value>I420</value>
      </field>
      <field name="pixel-aspect-ratio" type="fraction">
        <value>1/1</value>
        <value>12/11</value>
        <value>10/11</value>
        <value>16/11</value>
        <value>40/33</value>
        <value>44/33</value>
        <value>64/33</value>
        <value>160/99</value>
        <value>18/11</value>
        <value>15/11</value>
        <value>24/11</value>
        <value>60/33</value>
        <value>20/11</value>
        <value>32/11</value>
        <value>80/33</value>
      </field>
    </restriction>

    <restriction id="AVC_BL_384" type="video">
      <parent name="AVC_BL_C" />

      <field name="level" type="string">
        <value>1</value>
        <value>1b</value>
        <value>1.1</value>
        <value>1.2</value>
      </field>
      <field name="bitrate" type="int">
        <range min="0" max="384000" />
      </field>
    </restriction>

    <restriction id="AVC_BL_L3L" type="video">
      <parent name="AVC_BL_C" />
      <field name="level" type="string">
        <value>1</value>
        <value>1b</value>
        <value>1.1</value>
        <value>1.2</value>
        <value>1.3</value>
        <value>2</value>
        <value>2.1</value>
        <value>2.2</value>
        <value>3</value>
      </field>
      <field name="bitrate" type="int">
        <!--- Conservative estimate from a system bitrate of 5 Mbps, and audio
              bitrate of 256 kbps -->
        <range min="1" max="4500000" />
      </field>
    </restriction>

    <restriction id="AVC_BL_L3" type="video">
      <parent name="AVC_BL_L3L" />
      <field name="profile" type="string">
        <!-- constrained-baseline is a subset of baseline, but that's already
             handled in the L3L profile -->
        <value>baseline</value>
      </field>
      <field name="bitrate" type="int">
        <range min="1" max="4000000" />
      </field>
    </restriction>

    <restriction id="AVC_BL_625_D1" type="video">
      <parent name="625_D1" />
      <parent name="25fps" />
    </restriction>

    <restriction id="AVC_BL_525_D1" type="video">
      <parent name="525_D1" />
      <parent name="29.97fps" />
    </restriction>

    <restriction id="AVC_BL_VGA" type="video">
      <parent name="VGA" />
      <parent name="30fps" />
    </restriction>

    <restriction id="AVC_BL_VGA_16:9" type="video">
      <parent name="VGA_16:9" />
      <parent name="30fps" />
    </restriction>

    <restriction id="AVC_BL_CIF" type="video">
      <parent name="CIF" />
      <parent name="15fps" />
    </restriction>

    <restriction id="AVC_BL_525SIF" type="video">
      <parent name="525SIF" />
      <field name="framerate" type="fraction">
        <range min="0/1" max="18/1" />
      </field>
    </restriction>

    <restriction id="AVC_BL_QVGA_4:3" type="video">
      <parent name="QVGA_4:3" />
      <field name="framerate" type="fraction">
        <range min="0/1" max="20/1" />
      </field>
    </restriction>

    <restriction id="AVC_BL_QVGA_16:9" type="video">
      <parent name="QVGA_16:9" />
      <field name="framerate" type="fraction">
        <range min="0/1" max="26/1" />
      </field>
    </restriction>

    <restriction id="AVC_BL_1/7_VGA_4:3" type="video">
      <parent name="1/7_VGA_4:3" />
      <parent name="30fps" />
    </restriction>

    <restriction id="AVC_BL_1/9_VGA_4:3" type="video">
      <parent name="1/9_VGA_4:3" />
      <parent name="30fps" />
    </restriction>

    <restriction id="AVC_BL_QCIF" type="video">
      <parent name="QCIF" />
      <parent name="30fps" />
    </restriction>

    <restriction id="AVC_BL_525QSIF" type="video">
      <parent name="525QSIF" />
      <parent name="30fps" />
    </restriction>

    <restriction id="AVC_BL_SQVGA_4:3" type="video">
      <parent name="SQVGA_4:3" />
      <parent name="30fps" />
    </restriction>

    <restriction id="AVC_BL_1/16_VGA_4:3" type="video">
      <parent name="1/16_VGA_4:3" />
      <parent name="30fps" />
    </restriction>

    <restriction id="AVC_BL_SQVGA_16:9" type="video">
      <parent name="SQVGA_16:9" />
      <parent name="30fps" />
    </restriction>

    <restriction id="AVC_BL_SQCIF" type="video">
      <parent name="SQCIF" />
      <parent name="30fps" />
    </restriction>

    <restriction id="AVC_BL_1/7_VGA_16:9" type="video">
      <parent name="1/7_VGA_16:9" />
      <parent name="30fps" />
    </restriction>

  </restrictions>

  <dlna-profile id="AVC_MP4_BL_CIF15">
    <!-- FIXME: we have no way of matching the system bitrate -->
    <parent name="MP4" />

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_CIF" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_525SIF" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_QVGA_4:3" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_QVGA_16:9" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_1/7_VGA_4:3" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_1/9_VGA_4:3" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_QCIF" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_525QSIF" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_SQVGA_4:3" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_1/16_VGA_4:3" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_SQVGA_16:9" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_SQCIF" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_384" />
      <parent name="AVC_BL_1/7_VGA_16:9" />
    </restriction>
  </dlna-profile>

  <dlna-profile name="AVC_MP4_BL_CIF15_AAC_520" mime="video/mp4"
    base-profile="AVC_MP4_BL_CIF15">

    <restriction type="audio">
      <parent name="AAC" />
      <field name="bitrate" type="int">
        <range min="1" max="128000" />
      </field>
    </restriction>
  </dlna-profile>

  <dlna-profile name="AVC_MP4_BL_CIF15_AAC" mime="video/mp4"
    base-profile="AVC_MP4_BL_CIF15">

    <restriction type="audio">
      <parent name="AAC" />
      <!-- system bitrate <= 600 kbps, video bitrate <= 384 kbps, so assuming a
           container overhead of 16 kbps, audio bitrate <= 200 kbps -->
      <field name="bitrate" type="int">
        <range min="1" max="200000" />
      </field>
    </restriction>
  </dlna-profile>

  <dlna-profile name="AVC_MP4_BL_L3L_SD_AAC" mime="video/mp4">
    <parent name="MP4" />

    <parent name="AVC_BL_L3_AAC" />

    <!--
      Note: the AVC_MP4_BL_L3L_SD_AAC resolutions are missing from the DLNA
      spec, so I'm just reusing the ones from AVC_MP4_L3_SD_AAC.
    -->

    <restriction type="video">
      <parent name="AVC_BL_L3L" />
      <parent name="AVC_BL_625_D1" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_L3L" />
      <parent name="AVC_BL_525_D1" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_L3L" />
      <parent name="AVC_BL_VGA" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_L3L" />
      <parent name="AVC_BL_VGA_16:9" />
    </restriction>
  </dlna-profile>

  <dlna-profile name="AVC_MP4_BL_L3_SD_AAC" mime="video/mp4">
    <parent name="MP4" />

    <parent name="AVC_BL_L3_AAC" />

    <restriction type="video">
      <parent name="AVC_BL_L3" />
      <parent name="AVC_BL_625_D1" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_L3" />
      <parent name="AVC_BL_525_D1" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_L3" />
      <parent name="AVC_BL_VGA" />
    </restriction>

    <restriction type="video">
      <parent name="AVC_BL_L3" />
      <parent name="AVC_BL_VGA_16:9" />
    </restriction>
  </dlna-profile>
</dlna-profiles>
